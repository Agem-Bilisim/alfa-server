/**
 * 
 */
package tr.com.agem.alfa.testdata;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;
import java.util.Random;
import java.util.UUID;

import org.apache.commons.lang3.StringUtils;

/**
 * @author <a href="mailto:ali.ozeren@agem.com.tr">Ali Ozkan Ozeren</a>
 *
 */

public class CreateData {

	private static String randomMACAddress(){
	    Random rand = new Random();
	    byte[] macAddr = new byte[6];
	    rand.nextBytes(macAddr);

	    StringBuilder sb = new StringBuilder(18);
	    for(byte b : macAddr){
	        if(sb.length() > 0){
	            sb.append(":");
	        }else{ //first byte, we need to set some options
	            b = (byte)(b | (byte)(0x01 << 6)); //locally adminstrated
	            b = (byte)(b | (byte)(0x00 << 7)); //unicast

	        }
	        sb.append(String.format("%02x", b));
	    }


	    return sb.toString();
	}
	
	private static final String MACHINE_KEY = "#machine_key#";
	private static final String MAC_ADRR1 = "#mac_addr1#";
	private static final String MAC_ADRR2 = "#mac_addr2#";
	private static final String IP_ADRR1 = "#ip_addr1#";
	private static final String IP_ADRR2 = "#ip_addr2#";
	private static final String USER = "#user#";
	private static final String HOSTNAME = "#hostname#";
	

	private static void sendRequest(int i) throws IOException {
		
		String mac1 = randomMACAddress();
		String mac2 = randomMACAddress();
		String key = UUID.nameUUIDFromBytes((mac1 + mac2).getBytes()).toString();
		String ip1 = "192.168.1." + i;
		String ip2 = "169.254.195." + i;
		String user = "student" + StringUtils.leftPad(Integer.toString(i),3,'0');
		
		
		
		URL url = new URL("http://127.0.0.1:8080/alfa/agent/sysinfo-result");
		
		HttpURLConnection conn = (HttpURLConnection) url.openConnection();
		conn.setDoOutput(true);
		conn.setRequestMethod("POST");
		conn.setRequestProperty("Content-Type", "application/json");

		OutputStream os = conn.getOutputStream();

		String query= StringUtils.replace(query_windows, MACHINE_KEY, key);
		query= StringUtils.replace(query, USER, user);
		query= StringUtils.replace(query, MAC_ADRR1, mac1);
		query= StringUtils.replace(query, MAC_ADRR2, mac2);
		query= StringUtils.replace(query, IP_ADRR1, ip1);
		query= StringUtils.replace(query, IP_ADRR2, ip2);
		query= StringUtils.replace(query, HOSTNAME, "machine-local-"+i);
		
		os.write(query.getBytes());
		os.flush();

		if (!(conn.getResponseCode() != HttpURLConnection.HTTP_CREATED || conn.getResponseCode() != HttpURLConnection.HTTP_OK)) {
			throw new RuntimeException("Failed : HTTP error code : "
				+ conn.getResponseCode());
		}

		os.close();
		conn.disconnect();
		
		conn = (HttpURLConnection) url.openConnection();
		conn.setDoOutput(true);
		conn.setRequestMethod("POST");
		conn.setRequestProperty("Content-Type", "application/json");

		os = conn.getOutputStream();

		query= StringUtils.replace(query_linux, MACHINE_KEY, key);
		query= StringUtils.replace(query, USER, user);
		query= StringUtils.replace(query, MAC_ADRR1, mac1);
		query= StringUtils.replace(query, MAC_ADRR2, mac2);
		query= StringUtils.replace(query, IP_ADRR1, ip1);
		query= StringUtils.replace(query, IP_ADRR2, ip2);
		query= StringUtils.replace(query, HOSTNAME, "machine-local-"+i);
		
		os.write(query.getBytes());
		os.flush();

		if (!(conn.getResponseCode() != HttpURLConnection.HTTP_CREATED || conn.getResponseCode() != HttpURLConnection.HTTP_OK)) {
			throw new RuntimeException("Failed : HTTP error code : "
				+ conn.getResponseCode());
		} 

		os.close();
		conn.disconnect();

		System.out.println("Agent created with id : " + key );
	}
	
	public static void main(String[] args) {
		try {
			for (int i = 10; i <= 10; i++) {
				sendRequest(i);
			}

		  } catch (Exception e) {
			e.printStackTrace();

		 }
	}

	private static final String query_windows = 
			"{\"from\":\"#machine_key#\",\"agent_install_path\":\"C:\\\\Users\\\\#user#\\\\Documents\\\\git\\\\alfa-agent\",\"platform\":{\"release\":\"\",\"node\":\"#hostname#@\",\"machine\":\"AMD64\",\"system\":\"Windows\",\"version\":\"10.0.14393\"},\"installed_packages\":[{\"name\":\"Visual Studio Community 2017\",\"version\":\"\"},{\"name\":\"Google Chrome\",\"version\":\"\"},{\"name\":\"JetBrains PyCharm Community Edition 2018.1.4\",\"version\":\"\"},{\"name\":\"Windows SDK Desktop Libs arm64\",\"version\":\"\"},{\"name\":\"Windows SDK Desktop Libs x86\",\"version\":\"\"},{\"name\":\"Windows IoT Extension SDK\",\"version\":\"\"},{\"name\":\"Microsoft Visual C++ 2013 Redistributable (x64) - 12.0.30501\",\"version\":\"\"},{\"name\":\"Windows Runtime Intellisense Content - en-us\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X64 ARM Cross Package\",\"version\":\"\"},{\"name\":\"Universal CRT Headers Libraries and Sources\",\"version\":\"\"},{\"name\":\"Windows SDK for Windows Store Apps Libs\",\"version\":\"\"},{\"name\":\"Microsoft Visual C++ 2013 x86 Minimum Runtime - 12.0.21005\",\"version\":\"\"},{\"name\":\"Windows SDK EULA\",\"version\":\"\"},{\"name\":\"Universal CRT Extension SDK\",\"version\":\"\"},{\"name\":\"MSI Development Tools\",\"version\":\"\"},{\"name\":\"Universal CRT Extension SDK\",\"version\":\"\"},{\"name\":\"Visual C++ Library CRT X86 Desktop Package\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium X64 X86 Cross Package\",\"version\":\"\"},{\"name\":\"Windows SDK for Windows Store Apps Contracts\",\"version\":\"\"},{\"name\":\"Visual C++ Library CRT ARM Redist Package\",\"version\":\"\"},{\"name\":\"Windows SDK Desktop Headers x64\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium X86 Base Resource Package\",\"version\":\"\"},{\"name\":\"Windows SDK Desktop Tools x86\",\"version\":\"\"},{\"name\":\"Windows SDK Desktop Tools arm64\",\"version\":\"\"},{\"name\":\"Windows Espc Package\",\"version\":\"\"},{\"name\":\"Visual C++ Library MFC X86 Package\",\"version\":\"\"},{\"name\":\"Microsoft Visual C++ 2017 x86 Additional Runtime - 14.14.26405\",\"version\":\"\"},{\"name\":\"Microsoft .NET Framework 4.6.1 SDK\",\"version\":\"\"},{\"name\":\"Visual C++ Extra Files\",\"version\":\"\"},{\"name\":\"Visual C++ Library CRT X86 Redist Package\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X64 ARM Cross Resource Package\",\"version\":\"\"},{\"name\":\"SDK ARM Additions\",\"version\":\"\"},{\"name\":\"Windows SDK Desktop Headers arm64\",\"version\":\"\"},{\"name\":\"Windows Software Development Kit for Windows Store Apps\",\"version\":\"\"},{\"name\":\"WinRT Intellisense Mobile - en-us\",\"version\":\"\"},{\"name\":\"WinRT Intellisense Desktop - en-us\",\"version\":\"\"},{\"name\":\"Windows SDK for Windows Store Apps Tools\",\"version\":\"\"},{\"name\":\"Windows SDK Facade Windows WinMD Versioned\",\"version\":\"\"},{\"name\":\"vs_communitymsires\",\"version\":\"\"},{\"name\":\"WinRT Intellisense UAP - en-us\",\"version\":\"\"},{\"name\":\"Windows SDK for Windows Store Apps Headers\",\"version\":\"\"},{\"name\":\"Visual C++ Library CRT X86 OneCore For Desktop Package\",\"version\":\"\"},{\"name\":\"Windows SDK ARM Desktop Tools\",\"version\":\"\"},{\"name\":\"Visual C++ Library CRT X64 Store Package\",\"version\":\"\"},{\"name\":\"Windows Team Extension SDK\",\"version\":\"\"},{\"name\":\"Windows SDK Modern Versioned Developer Tools\",\"version\":\"\"},{\"name\":\"Windows Mobile Extension SDK\",\"version\":\"\"},{\"name\":\"Visual C++ MSBuild X64 Package\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium X86 ARM Cross Package\",\"version\":\"\"},{\"name\":\"Visual C++ Library CRT Redist Resource Package\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X86 X64 Cross Resource Package\",\"version\":\"\"},{\"name\":\"Windows SDK Desktop Libs arm\",\"version\":\"\"},{\"name\":\"WinAppDeploy\",\"version\":\"\"},{\"name\":\"Microsoft Visual C++ 2017 Redistributable (x64) - 14.14.26405\",\"version\":\"\"},{\"name\":\"vs_communitymsi\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X64 Base Resource Package\",\"version\":\"\"},{\"name\":\"Windows Espc Package\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium X86 Base Package\",\"version\":\"\"},{\"name\":\"Visual C++ Library MFC MBCS Package\",\"version\":\"\"},{\"name\":\"Windows Software Development Kit - Windows 10.0.17134.12\",\"version\":\"\"},{\"name\":\"Google Update Helper\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium X64 ARM Cross Resource Package\",\"version\":\"\"},{\"name\":\"Microsoft Visual C++ 2017 x86 Minimum Runtime - 14.14.26405\",\"version\":\"\"},{\"name\":\"Windows Desktop Extension SDK\",\"version\":\"\"},{\"name\":\"Windows SDK Desktop Headers x86\",\"version\":\"\"},{\"name\":\"Visual C++ Library CRT X64 OneCore For Desktop Package\",\"version\":\"\"},{\"name\":\"Microsoft .NET Framework 4.5.1 Multi-Targeting Pack\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium X64 Base Resource Package\",\"version\":\"\"},{\"name\":\"Visual C++ Library MFC Source Package\",\"version\":\"\"},{\"name\":\"vs_minshellmsires\",\"version\":\"\"},{\"name\":\"Universal CRT Tools x86\",\"version\":\"\"},{\"name\":\"Windows SDK for Windows Store Apps Metadata\",\"version\":\"\"},{\"name\":\"Visual C++ Library CRT X64 Desktop Package\",\"version\":\"\"},{\"name\":\"Kits Configuration Installer\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium X64 ARM Cross Package\",\"version\":\"\"},{\"name\":\"WinRT Intellisense PPI - en-us\",\"version\":\"\"},{\"name\":\"Visual C++ Library ATL Headers Package\",\"version\":\"\"},{\"name\":\"Windows SDK\",\"version\":\"\"},{\"name\":\"Universal General MIDI DLS Extension SDK\",\"version\":\"\"},{\"name\":\"Visual C++ Library PGO X86 Package\",\"version\":\"\"},{\"name\":\"Visual C++ Library ATL Source Package\",\"version\":\"\"},{\"name\":\"Windows App Certification Kit x64\",\"version\":\"\"},{\"name\":\"Visual C++ MSBuild Base Resource Package\",\"version\":\"\"},{\"name\":\"SDK ARM Redistributables\",\"version\":\"\"},{\"name\":\"Windows Mobile Connectivity Tools 10.0.15254.0 - Desktop x86\",\"version\":\"\"},{\"name\":\"Windows SDK Desktop Headers arm\",\"version\":\"\"},{\"name\":\"Visual C++ Library MFC X64 Package\",\"version\":\"\"},{\"name\":\"WinRT Intellisense IoT - Other Languages\",\"version\":\"\"},{\"name\":\"Visual C++ Library CRT ARM Desktop Package\",\"version\":\"\"},{\"name\":\"Microsoft .NET Framework 4.6.1 Targeting Pack\",\"version\":\"\"},{\"name\":\"Universal CRT Headers Libraries and Sources\",\"version\":\"\"},{\"name\":\"Windows SDK Signing Tools\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium X86 X64 Cross Package\",\"version\":\"\"},{\"name\":\"Visual C++ Library ATL X64 Package\",\"version\":\"\"},{\"name\":\"vs_FileTracker_Singleton\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X86 Base Resource Package\",\"version\":\"\"},{\"name\":\"Visual C++ MSBuild ARM Package\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium X64 Native Resource Package\",\"version\":\"\"},{\"name\":\"Visual C++ Library ATL ARM Package\",\"version\":\"\"},{\"name\":\"WinRT Intellisense IoT - en-us\",\"version\":\"\"},{\"name\":\"Microsoft Visual Studio Setup Configuration\",\"version\":\"\"},{\"name\":\"Windows Software Development Kit\",\"version\":\"\"},{\"name\":\"Visual C++ MSBuild X86 Package\",\"version\":\"\"},{\"name\":\"Windows SDK Modern Non-Versioned Developer Tools\",\"version\":\"\"},{\"name\":\"Windows Mobile Extension SDK Contracts\",\"version\":\"\"},{\"name\":\"vs_minshellinteropmsi\",\"version\":\"\"},{\"name\":\"Visual C++ Extra Resource Files\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X64 Native Package\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium ARM Base Resource Package\",\"version\":\"\"},{\"name\":\"Python 3.5.0 Launcher (32-bit)\",\"version\":\"\"},{\"name\":\"Windows SDK Desktop Libs x64\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X64 Base Package\",\"version\":\"\"},{\"name\":\"Microsoft Build Tools Language Resources 14.0 (x86)\",\"version\":\"\"},{\"name\":\"Visual C++ Library MFC Headers Package\",\"version\":\"\"},{\"name\":\"Windows SDK Desktop Tools x64\",\"version\":\"\"},{\"name\":\"Microsoft HTML Help Workshop Package\",\"version\":\"\"},{\"name\":\"Visual C++ MSBuild Base Package\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X64 X86 Cross Resource Package\",\"version\":\"\"},{\"name\":\"Visual C++ Library CRT X64 Redist Package\",\"version\":\"\"},{\"name\":\"Visual C++ Library ATL X86 Package\",\"version\":\"\"},{\"name\":\"Universal CRT Redistributable\",\"version\":\"\"},{\"name\":\"vs_filehandler_amd64\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium X64 Base Package\",\"version\":\"\"},{\"name\":\"Microsoft .NET Framework 4.7.1 SDK\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X86 ARM Cross Resource Package\",\"version\":\"\"},{\"name\":\"Visual C++ CRT Headers Package\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium X86 Native Resource Package\",\"version\":\"\"},{\"name\":\"Visual C++ Library PGO Headers Package\",\"version\":\"\"},{\"name\":\"vs_devenvmsi\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium X86 Native Package\",\"version\":\"\"},{\"name\":\"Python Launcher\",\"version\":\"\"},{\"name\":\"Windows Desktop Extension SDK Contracts\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium X64 X86 Cross Resource Package\",\"version\":\"\"},{\"name\":\"WinRT Intellisense UAP - Other Languages\",\"version\":\"\"},{\"name\":\"WinRT Intellisense Desktop - Other Languages\",\"version\":\"\"},{\"name\":\"Windows SDK for Windows Store Apps\",\"version\":\"\"},{\"name\":\"Windows SDK for Windows Store Apps DirectX x86 Remote\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X86 X64 Cross Package\",\"version\":\"\"},{\"name\":\"Visual C++ Library CRT X86 Store Package\",\"version\":\"\"},{\"name\":\"Microsoft .NET Framework 4 Multi-Targeting Pack\",\"version\":\"\"},{\"name\":\"Update for  (KB2504637)\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium X86 ARM Cross Resource Package\",\"version\":\"\"},{\"name\":\"Microsoft Build Tools 14.0 (x86)\",\"version\":\"\"},{\"name\":\"Microsoft Build Tools 2015\",\"version\":\"\"},{\"name\":\"Visual C++ Library PGO ARM Package\",\"version\":\"\"},{\"name\":\"Microsoft .NET Core SDK - 2.1.201 (x64)\",\"version\":\"\"},{\"name\":\"Windows IoT Extension SDK Contracts\",\"version\":\"\"},{\"name\":\"Windows SDK Redistributables\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X64 X86 Cross Package\",\"version\":\"\"},{\"name\":\"Visual C++ Library PGO X64 Package\",\"version\":\"\"},{\"name\":\"Visual C++ Library CRT Source Package\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X64 Native Resource Package\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium X64 Native Package\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X86 Native Resource Package\",\"version\":\"\"},{\"name\":\"Windows SDK for Windows Store Managed Apps Libs\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X86 Native Package\",\"version\":\"\"},{\"name\":\"Windows SDK AddOn\",\"version\":\"\"},{\"name\":\"Visual C++ Library CRT ARM Store Package\",\"version\":\"\"},{\"name\":\"Microsoft Visual C++ 2017 Redistributable (x86) - 14.14.26405\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X86 Base Package\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium ARM Base Package\",\"version\":\"\"},{\"name\":\"vs_filehandler_x86\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X86 Base Package\",\"version\":\"\"},{\"name\":\"Visual C++ Library CRT ARM OneCore For Desktop Package\",\"version\":\"\"},{\"name\":\"WinRT Intellisense PPI - Other Languages\",\"version\":\"\"},{\"name\":\"vs_minshellmsi\",\"version\":\"\"},{\"name\":\"Microsoft Visual C++ 2013 Redistributable (x86) - 12.0.30501\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools X86 ARM Cross Package\",\"version\":\"\"},{\"name\":\"Microsoft Visual C++ 2013 x86 Additional Runtime - 12.0.21005\",\"version\":\"\"},{\"name\":\"Windows Team Extension SDK Contracts\",\"version\":\"\"},{\"name\":\"Visual C++ Compiler/Tools Premium X86 X64 Cross Resource Package\",\"version\":\"\"},{\"name\":\"Visual C++ Library PGO X86 Package\",\"version\":\"\"},{\"name\":\"Windows SDK DirectX x86 Remote\",\"version\":\"\"},{\"name\":\"Windows App Certification Kit SupportedApiList x86\",\"version\":\"\"}],\"disk\":{\"diskPartitions\":null,\"devices\":[{\"vendor\":\"Toshiba\",\"id\":null,\"physid\":null,\"handle\":null,\"capabilities\":null,\"description\":\"Toshiba P300\",\"configuration\":null,\"businfo\":null,\"children\":null,\"version\":\"12ef92890\",\"logicalname\":null,\"dev\":null,\"product\":\"Toshiba P300\",\"claimed\":null,\"size\":null,\"serial\":\"9931sdks9212as\",\"units\":null,\"class\":null}],\"diskUsage\":null},\"cpu\":{\"processor\":\"Intel64 Family 6 Model 42 Stepping 7, GenuineIntel\",\"model\":42,\"stats\":[4113215,3878709,0,26625219],\"arch\":\"X86_64\",\"extendedModel\":null,\"flags\":[\"acpi\",\"aes\",\"apic\",\"avx\",\"clflush\",\"cmov\",\"cx16\",\"cx8\",\"de\",\"ds_cpl\",\"dtes64\",\"dts\",\"est\",\"fpu\",\"fxsr\",\"ht\",\"ia64\",\"lahf_lm\",\"mca\",\"mce\",\"mmx\",\"monitor\",\"msr\",\"mtrr\",\"osxsave\",\"pae\",\"pat\",\"pbe\",\"pcid\",\"pclmulqdq\",\"pdcm\",\"pge\",\"pni\",\"popcnt\",\"pse\",\"pse36\",\"sep\",\"serial\",\"ss\",\"sse\",\"sse2\",\"sse4_1\",\"sse4_2\",\"ssse3\",\"tm\",\"tm2\",\"tsc\",\"tscdeadline\",\"vme\",\"vmx\",\"x2apic\",\"xsave\",\"xtpr\"],\"l2CacheAssociativity\":null,\"bits\":64,\"l2CacheLineSize\":null,\"family\":6,\"l2CacheSize\":null,\"count\":4,\"stepping\":7,\"brand\":\"Intel(R) Core(TM) i5-2410M CPU @ 2.30GHz\",\"extendedFamily\":null,\"hz_advertised\":\"2.3000 GHz\",\"raw_arch_string\":\"AMD64\",\"cpu-times\":[609.0,179.10938,3654.5469,11.1875,9.0],\"cpuinfo_version\":[4,0,0],\"hz_advertised_raw\":[\"2300000000\",\"0\"],\"logical-core-count\":4,\"hz_actual\":\"2.3010 GHz\",\"vendor_id\":\"GenuineIntel\",\"pyhsical-core-count\":2,\"hz_actual_raw\":[\"2301000000\",\"0\"]},\"bios\":{\"vendor\":\"Acer         \",\"version\":\"ACRSYS - 1\",\"releaseDate\":null},\"peripheral_devices\":[],\"gpu\":{\"devices\":[{\"subsystem\":\"NVIDIA GeForce GT 520M   Intel(R) HD Graphics 3000\",\"kernel\":\"GeForce GT 520M            Intel(R) HD Graphics Family\",\"memory\":\"10737418241935595520\",\"driver_date\":\"20161229000000.000000-00020160519000000.000000-000\",\"driver_version\":\"21.21.13.76549.17.10.4459\"}]},\"processes\":[{\"name\":\"System Idle Process\",\"cpuTimes\":null,\"pid\":0,\"cpuPercent\":null,\"username\":\"NT AUTHORITY\\\\SYSTEM\",\"memoryInfo\":null},{\"name\":\"System\",\"cpuTimes\":null,\"pid\":4,\"cpuPercent\":null,\"username\":\"NT AUTHORITY\\\\SYSTEM\",\"memoryInfo\":null},{\"name\":\"svchost.exe\",\"cpuTimes\":null,\"pid\":76,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"smss.exe\",\"cpuTimes\":null,\"pid\":352,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"csrss.exe\",\"cpuTimes\":null,\"pid\":456,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"wininit.exe\",\"cpuTimes\":null,\"pid\":556,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"csrss.exe\",\"cpuTimes\":null,\"pid\":564,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"services.exe\",\"cpuTimes\":null,\"pid\":640,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"winlogon.exe\",\"cpuTimes\":null,\"pid\":664,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"lsass.exe\",\"cpuTimes\":null,\"pid\":688,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"fsnotifier64.exe\",\"cpuTimes\":null,\"pid\":700,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"svchost.exe\",\"cpuTimes\":null,\"pid\":808,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"SkypeHost.exe\",\"cpuTimes\":null,\"pid\":816,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"svchost.exe\",\"cpuTimes\":null,\"pid\":824,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"svchost.exe\",\"cpuTimes\":null,\"pid\":880,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"svchost.exe\",\"cpuTimes\":null,\"pid\":952,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"dwm.exe\",\"cpuTimes\":null,\"pid\":992,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"svchost.exe\",\"cpuTimes\":null,\"pid\":1012,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"svchost.exe\",\"cpuTimes\":null,\"pid\":1180,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"svchost.exe\",\"cpuTimes\":null,\"pid\":1232,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"svchost.exe\",\"cpuTimes\":null,\"pid\":1372,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"NVDisplay.Container.exe\",\"cpuTimes\":null,\"pid\":1532,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"audiodg.exe\",\"cpuTimes\":null,\"pid\":1572,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"svchost.exe\",\"cpuTimes\":null,\"pid\":1576,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"SynTPEnhService.exe\",\"cpuTimes\":null,\"pid\":1612,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"svchost.exe\",\"cpuTimes\":null,\"pid\":1664,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"svchost.exe\",\"cpuTimes\":null,\"pid\":1672,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"svchost.exe\",\"cpuTimes\":null,\"pid\":1796,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"spoolsv.exe\",\"cpuTimes\":null,\"pid\":1880,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"SearchProtocolHost.exe\",\"cpuTimes\":null,\"pid\":1896,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"MsMpEng.exe\",\"cpuTimes\":null,\"pid\":2092,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"pycharm64.exe\",\"cpuTimes\":null,\"pid\":2124,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"NisSrv.exe\",\"cpuTimes\":null,\"pid\":2168,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"Memory Compression\",\"cpuTimes\":null,\"pid\":2184,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"SynTPEnh.exe\",\"cpuTimes\":null,\"pid\":2448,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"nvxdsync.exe\",\"cpuTimes\":null,\"pid\":2700,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"chrome.exe\",\"cpuTimes\":null,\"pid\":2732,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"igfxpers.exe\",\"cpuTimes\":null,\"pid\":2908,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"sihost.exe\",\"cpuTimes\":null,\"pid\":2960,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"svchost.exe\",\"cpuTimes\":null,\"pid\":3080,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"taskhostw.exe\",\"cpuTimes\":null,\"pid\":3116,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"SearchIndexer.exe\",\"cpuTimes\":null,\"pid\":3376,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"RuntimeBroker.exe\",\"cpuTimes\":null,\"pid\":3392,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"explorer.exe\",\"cpuTimes\":null,\"pid\":3544,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"ShellExperienceHost.exe\",\"cpuTimes\":null,\"pid\":3596,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"SynTPHelper.exe\",\"cpuTimes\":null,\"pid\":3640,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"conhost.exe\",\"cpuTimes\":null,\"pid\":3700,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"GoogleCrashHandler.exe\",\"cpuTimes\":null,\"pid\":3724,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"GoogleCrashHandler64.exe\",\"cpuTimes\":null,\"pid\":3736,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"MpCmdRun.exe\",\"cpuTimes\":null,\"pid\":3812,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"OneDrive.exe\",\"cpuTimes\":null,\"pid\":3932,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"SearchUI.exe\",\"cpuTimes\":null,\"pid\":4136,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"ApplicationFrameHost.exe\",\"cpuTimes\":null,\"pid\":4424,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"hkcmd.exe\",\"cpuTimes\":null,\"pid\":4800,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"igfxtray.exe\",\"cpuTimes\":null,\"pid\":4804,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"MSASCuiL.exe\",\"cpuTimes\":null,\"pid\":4992,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"nvtray.exe\",\"cpuTimes\":null,\"pid\":5000,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"chrome.exe\",\"cpuTimes\":null,\"pid\":5384,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"svchost.exe\",\"cpuTimes\":null,\"pid\":5388,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"HelpPane.exe\",\"cpuTimes\":null,\"pid\":5556,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"dllhost.exe\",\"cpuTimes\":null,\"pid\":5768,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"svchost.exe\",\"cpuTimes\":null,\"pid\":5848,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"python.exe\",\"cpuTimes\":null,\"pid\":6008,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"chrome.exe\",\"cpuTimes\":null,\"pid\":6188,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"chrome.exe\",\"cpuTimes\":null,\"pid\":6572,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"SearchFilterHost.exe\",\"cpuTimes\":null,\"pid\":6896,\"cpuPercent\":null,\"username\":null,\"memoryInfo\":null},{\"name\":\"conhost.exe\",\"cpuTimes\":null,\"pid\":6952,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null},{\"name\":\"chrome.exe\",\"cpuTimes\":null,\"pid\":7164,\"cpuPercent\":null,\"username\":\"#hostname#@\\\\#user#\",\"memoryInfo\":null}],\"users\":[\"#user#\"],\"network\":{\"devices\":[{\"vendor\":\"Qualcomm Atheros AR5B97 Wireless Network AdapterBroadcom NetLink (TM) Gigabit Ethernet\",\"id\":null,\"physid\":null,\"handle\":null,\"capabilities\":null,\"description\":null,\"configuration\":null,\"businfo\":null,\"children\":null,\"version\":\"3.0.2.202    15.6.1.3\",\"logicalname\":null,\"dev\":null,\"product\":\"Driver Date 2016-01-29 Version 3.0.2.202 NDIS 6.40Driver Date 2015-08-18 Version 15.6.1.3 NDIS 6.30\",\"claimed\":null,\"size\":null,\"serial\":null,\"units\":null,\"class\":null}],\"mac_addresses\":[\"#mac_addr1#\",\"#mac_addr2#\"],\"ip_addresses\":[\"#ip_addr1#\",\"#ip_addr2#\"],\"interface_addresses\":[{\"inet\":\"Wi-Fi\",\"addr\":[{\"address\":\"#mac_addr1#\",\"ptp\":null,\"family\":-1,\"netmask\":null,\"broadcast\":null},{\"address\":\"#ip_addr1#\",\"ptp\":null,\"family\":2,\"netmask\":\"255.255.255.0\",\"broadcast\":null},{\"address\":\"fe80::38f0:ccc0:beb8:b9cb\",\"ptp\":null,\"family\":23,\"netmask\":null,\"broadcast\":null}]},{\"inet\":\"Ethernet\",\"addr\":[{\"address\":\"#mac_addr2#\",\"ptp\":null,\"family\":-1,\"netmask\":null,\"broadcast\":null},{\"address\":\"#ip_addr2#\",\"ptp\":null,\"family\":2,\"netmask\":\"255.255.0.0\",\"broadcast\":null},{\"address\":\"fe80::5c9c:db93:a802:c333\",\"ptp\":null,\"family\":23,\"netmask\":null,\"broadcast\":null}]}]},\"memory\":{\"virtualMemory\":null,\"swapMemory\":null,\"devices\":[{\"speed\":\"1333\",\"size\":\"2048\",\"type\":\"DDR3\",\"manufacturer\":\"Nanya Technology\"},{\"speed\":\"1333\",\"size\":\"2048\",\"type\":\"DDR3\",\"manufacturer\":\"Nanya Technology\"}]}}";
	
	private static final String query_linux = "{\"from\":\"#machine_key#\",\"agent_install_path\":\"/home/#user#/git/alfa-agent\",\"platform\":{\"release\":\"4.15.0-20-generic\",\"node\":\"#hostname#-pardus\",\"machine\":\"x86_64\",\"system\":\"Linux\",\"version\":\"#21-Pardus SMP Tue Apr 24 06:16:15 UTC 2018\"},\"installed_packages\":[{\"name\":\"accountsservice\",\"version\":\"0.6.45-1pardus1\"},{\"name\":\"acl\",\"version\":\"2.2.52-3build1\"},{\"name\":\"acpi-support\",\"version\":\"0.142\"},{\"name\":\"acpid\",\"version\":\"1:2.0.28-1pardus1\"},{\"name\":\"adduser\",\"version\":\"3.116pardus1\"},{\"name\":\"adium-theme-pardus\",\"version\":\"0.3.4-0pardus4\"},{\"name\":\"adwaita-icon-theme\",\"version\":\"3.28.0-1pardus1\"},{\"name\":\"aisleriot\",\"version\":\"1:3.22.5-1\"},{\"name\":\"alsa-base\",\"version\":\"1.0.25+dfsg-0pardus5\"},{\"name\":\"alsa-utils\",\"version\":\"1.1.3-1pardus1\"},{\"name\":\"anacron\",\"version\":\"2.3-24\"},{\"name\":\"apg\",\"version\":\"2.2.3.dfsg.1-5\"},{\"name\":\"app-install-data-partner\",\"version\":\"16.04\"},{\"name\":\"apparmor\",\"version\":\"2.12-4pardus5\"},{\"name\":\"apport\",\"version\":\"2.20.9-0pardus7\"},{\"name\":\"apport-gtk\",\"version\":\"2.20.9-0pardus7\"},{\"name\":\"apport-symptoms\",\"version\":\"0.20\"},{\"name\":\"appstream\",\"version\":\"0.12.0-3\"},{\"name\":\"apt\",\"version\":\"1.6.1\"},{\"name\":\"apt-config-icons\",\"version\":\"0.12.0-3\"},{\"name\":\"apt-utils\",\"version\":\"1.6.1\"},{\"name\":\"aptdaemon\",\"version\":\"1.1.1+bzr982-0pardus19\"},{\"name\":\"aptdaemon-data\",\"version\":\"1.1.1+bzr982-0pardus19\"},{\"name\":\"apturl\",\"version\":\"0.5.2pardus14\"},{\"name\":\"apturl-common\",\"version\":\"0.5.2pardus14\"},{\"name\":\"aspell\",\"version\":\"0.60.7~20110707-4\"},{\"name\":\"aspell-en\",\"version\":\"2017.08.24-0-0.1\"},{\"name\":\"at-spi2-core\",\"version\":\"2.28.0-1\"},{\"name\":\"avahi-autoipd\",\"version\":\"0.7-3.1pardus1\"},{\"name\":\"avahi-daemon\",\"version\":\"0.7-3.1pardus1\"},{\"name\":\"avahi-utils\",\"version\":\"0.7-3.1pardus1\"},{\"name\":\"baobab\",\"version\":\"3.28.0-1\"},{\"name\":\"base-files\",\"version\":\"10.1pardus2\"},{\"name\":\"base-passwd\",\"version\":\"3.5.44\"},{\"name\":\"bash\",\"version\":\"4.4.18-2pardus1\"},{\"name\":\"bash-completion\",\"version\":\"1:2.8-1pardus1\"},{\"name\":\"bc\",\"version\":\"1.07.1-2\"},{\"name\":\"bind9-host\",\"version\":\"1:9.11.3+dfsg-1pardus1\"},{\"name\":\"binutils\",\"version\":\"2.30-15pardus1\"},{\"name\":\"binutils-common:amd64\",\"version\":\"2.30-15pardus1\"},{\"name\":\"binutils-x86-64-linux-gnu\",\"version\":\"2.30-15pardus1\"},{\"name\":\"bluez\",\"version\":\"5.48-0pardus3\"},{\"name\":\"bluez-cups\",\"version\":\"5.48-0pardus3\"},{\"name\":\"bluez-obexd\",\"version\":\"5.48-0pardus3\"},{\"name\":\"bolt\",\"version\":\"0.2-0pardus1\"},{\"name\":\"branding-pardus\",\"version\":\"0.10\"},{\"name\":\"brltty\",\"version\":\"5.5-4pardus2\"},{\"name\":\"bsdmainutils\",\"version\":\"11.1.2pardus1\"},{\"name\":\"bsdutils\",\"version\":\"1:2.31.1-0.4pardus3\"},{\"name\":\"build-essential\",\"version\":\"12.4pardus1\"},{\"name\":\"busybox-initramfs\",\"version\":\"1:1.27.2-2pardus3\"},{\"name\":\"busybox-static\",\"version\":\"1:1.27.2-2pardus3\"},{\"name\":\"bzip2\",\"version\":\"1.0.6-8.1\"},{\"name\":\"ca-certificates\",\"version\":\"20180409\"},{\"name\":\"cheese\",\"version\":\"3.28.0-1pardus1\"},{\"name\":\"cheese-common\",\"version\":\"3.28.0-1pardus1\"},{\"name\":\"colord\",\"version\":\"1.3.3-2build1\"},{\"name\":\"colord-data\",\"version\":\"1.3.3-2build1\"},{\"name\":\"command-not-found\",\"version\":\"18.04.4\"},{\"name\":\"command-not-found-data\",\"version\":\"18.04.4\"},{\"name\":\"console-setup\",\"version\":\"1.178pardus2\"},{\"name\":\"console-setup-linux\",\"version\":\"1.178pardus2\"},{\"name\":\"coreutils\",\"version\":\"8.28-1pardus1\"},{\"name\":\"cpio\",\"version\":\"2.12+dfsg-6\"},{\"name\":\"cpp\",\"version\":\"4:7.3.0-3pardus2\"},{\"name\":\"cpp-7\",\"version\":\"7.3.0-16pardus3\"},{\"name\":\"cracklib-runtime\",\"version\":\"2.9.2-5build1\"},{\"name\":\"crda\",\"version\":\"3.18-1build1\"},{\"name\":\"cron\",\"version\":\"3.0pl1-128.1pardus1\"},{\"name\":\"cups\",\"version\":\"2.2.7-1pardus2\"},{\"name\":\"cups-browsed\",\"version\":\"1.20.2-0pardus3\"},{\"name\":\"cups-bsd\",\"version\":\"2.2.7-1pardus2\"},{\"name\":\"cups-client\",\"version\":\"2.2.7-1pardus2\"},{\"name\":\"cups-common\",\"version\":\"2.2.7-1pardus2\"},{\"name\":\"cups-core-drivers\",\"version\":\"2.2.7-1pardus2\"},{\"name\":\"cups-daemon\",\"version\":\"2.2.7-1pardus2\"},{\"name\":\"cups-filters\",\"version\":\"1.20.2-0pardus3\"},{\"name\":\"cups-filters-core-drivers\",\"version\":\"1.20.2-0pardus3\"},{\"name\":\"cups-ipp-utils\",\"version\":\"2.2.7-1pardus2\"},{\"name\":\"cups-pk-helper\",\"version\":\"0.2.6-1pardus1\"},{\"name\":\"cups-ppdc\",\"version\":\"2.2.7-1pardus2\"},{\"name\":\"cups-server-common\",\"version\":\"2.2.7-1pardus2\"},{\"name\":\"dash\",\"version\":\"0.5.8-2.10\"},{\"name\":\"dbus\",\"version\":\"1.12.2-1pardus1\"},{\"name\":\"dbus-user-session\",\"version\":\"1.12.2-1pardus1\"},{\"name\":\"dbus-x11\",\"version\":\"1.12.2-1pardus1\"},{\"name\":\"dc\",\"version\":\"1.07.1-2\"},{\"name\":\"dconf-cli\",\"version\":\"0.26.0-2pardus3\"},{\"name\":\"dconf-gsettings-backend:amd64\",\"version\":\"0.26.0-2pardus3\"},{\"name\":\"dconf-service\",\"version\":\"0.26.0-2pardus3\"},{\"name\":\"debconf\",\"version\":\"1.5.66\"},{\"name\":\"debconf-i18n\",\"version\":\"1.5.66\"},{\"name\":\"debianutils\",\"version\":\"4.8.4\"},{\"name\":\"deja-dup\",\"version\":\"37.1-2fakesync1\"},{\"name\":\"desktop-file-utils\",\"version\":\"0.23-1pardus3\"},{\"name\":\"dh-python\",\"version\":\"3.20180325pardus2\"},{\"name\":\"dictionaries-common\",\"version\":\"1.27.2\"},{\"name\":\"diffstat\",\"version\":\"1.61-1build1\"},{\"name\":\"diffutils\",\"version\":\"1:3.6-1\"},{\"name\":\"dirmngr\",\"version\":\"2.2.4-1pardus1\"}],\"bios\":{\"vendor\":\"Acer\",\"version\":\"V1.05\",\"releaseDate\":null},\"users\":[\"#user#\"],\"network\":{\"devices\":null,\"mac_addresses\":[\"#mac_addr1#\",\"#mac_addr2#\"],\"ip_addresses\":[\"#ip_addr1#\",\"#ip_addr2#\"],\"interface_addresses\":null}}";
}
